(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[100],{8911:function(e,t,s){Promise.resolve().then(s.bind(s,1842))},1842:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return x}});var r=s(7437),a=s(2265),o=s(9376),n=s(4190),i=s(2449),l=s(8930),c=s(1047),m=s(9397),d=s(407);let u=[{id:"prod1",name:"Organic Bananas",description:"Sweet and nutritious organic bananas, perfect for snacking or baking.",price:.79,salePrice:.69,onSale:!0,image:"https://images.unsplash.com/photo-1543218024-57a70143c369?auto=format&fit=crop&w=300&q=80",category:"Produce",unit:"each",stock:100},{id:"prod2",name:"Avocado",description:"Ripe and ready to eat avocados, perfect for guacamole or toast.",price:1.99,image:"https://images.unsplash.com/photo-1523049673857-eb18f1d7b578?auto=format&fit=crop&w=300&q=80",category:"Produce",unit:"each",stock:50},{id:"prod3",name:"Fresh Strawberries",description:"Juicy and sweet strawberries, perfect for desserts or snacking.",price:4.99,salePrice:3.99,onSale:!0,image:"https://images.unsplash.com/photo-1464965911861-746a04b4bca6?auto=format&fit=crop&w=300&q=80",category:"Produce",unit:"lb",stock:30},{id:"prod4",name:"Whole Milk",description:"Fresh whole milk from local farms.",price:3.49,image:"https://images.unsplash.com/photo-1550583724-b2692b85b150?auto=format&fit=crop&w=300&q=80",category:"Dairy",unit:"gallon",stock:40},{id:"prod5",name:"Organic Eggs",description:"Farm fresh organic eggs, dozen.",price:5.99,image:"https://images.unsplash.com/photo-1582722872445-44dc5f7e3c8f?auto=format&fit=crop&w=300&q=80",category:"Dairy",unit:"dozen",stock:60}],h=[{id:"store1",name:"Fresh Grocery",logo:"https://images.unsplash.com/photo-1534723452862-4c874018d66d?auto=format&fit=crop&w=300&q=80",deliveryFee:3.99,minimumOrder:10},{id:"store2",name:"Organic Market",logo:"https://images.unsplash.com/photo-1542838132-92c53300491e?auto=format&fit=crop&w=300&q=80",deliveryFee:4.99,minimumOrder:15}];function x(){let e=(0,o.useRouter)(),{user:t,isAuthenticated:s,isLoading:x}=(0,n.a)(),[p,f]=(0,a.useState)({}),[g,y]=(0,a.useState)(null),[b,j]=(0,a.useState)(null),[v,w]=(0,a.useState)(!0),[N,k]=(0,a.useState)(0);(0,a.useEffect)(()=>{let e=localStorage.getItem("cart"),t=localStorage.getItem("storeId");if(e&&f(JSON.parse(e)),t){y(t);let e=h.find(e=>e.id===t);e&&j(e)}w(!1)},[]),(0,a.useEffect)(()=>{let e=0;Object.entries(p).forEach(t=>{let[s,r]=t,a=u.find(e=>e.id===s);if(a){let t=a.onSale&&a.salePrice||a.price;e+=t*r}}),k(e)},[p]),(0,a.useEffect)(()=>{Object.keys(p).length>0?localStorage.setItem("cart",JSON.stringify(p)):localStorage.removeItem("cart")},[p]),(0,a.useEffect)(()=>{x||s||e.push("/auth/login")},[x,s,e]);let S=(e,t)=>{if(t<=0){O(e);return}let s=u.find(t=>t.id===e);if(s&&t>s.stock){alert("Only ".concat(s.stock," ").concat(s.unit,"(s) available in stock"));return}f(s=>({...s,[e]:t}))},O=e=>{f(t=>{let s={...t};return delete s[e],s})};return x||v?(0,r.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-brand-500"})}):0===Object.keys(p).length?(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8 text-center",children:[(0,r.jsx)(i.Z,{className:"mx-auto h-16 w-16 text-gray-400 mb-4"}),(0,r.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Your cart is empty"}),(0,r.jsx)("p",{className:"text-gray-600 mb-6",children:"Start shopping to add items to your cart."}),(0,r.jsx)("button",{onClick:()=>e.push("/stores"),className:"bg-brand-500 text-white px-6 py-3 rounded-md hover:bg-brand-600 transition-colors",children:"Browse Stores"})]}):(0,r.jsxs)("div",{className:"container mx-auto px-4 sm:px-6 py-6 sm:py-8",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4 sm:mb-6",children:[(0,r.jsx)("h1",{className:"text-xl sm:text-2xl font-bold",children:"Shopping Cart"}),(0,r.jsxs)("button",{onClick:()=>{confirm("Are you sure you want to clear your cart?")&&(f({}),localStorage.removeItem("cart"),localStorage.removeItem("storeId"),y(null),j(null))},className:"text-red-500 hover:text-red-600 text-xs sm:text-sm font-medium flex items-center active:scale-95 touch-manipulation",children:[(0,r.jsx)(l.Z,{className:"mr-1 h-3.5 w-3.5 sm:h-4 sm:w-4"}),"Clear Cart"]})]}),(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4 sm:gap-6",children:[(0,r.jsxs)("div",{className:"lg:w-2/3",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md",children:[b&&(0,r.jsxs)("div",{className:"flex items-center p-4 border-b",children:[(0,r.jsx)("div",{className:"w-10 h-10 sm:w-12 sm:h-12 rounded-full overflow-hidden mr-2 sm:mr-3 flex-shrink-0",children:(0,r.jsx)("img",{src:b.logo,alt:b.name,className:"w-full h-full object-cover"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-sm sm:text-base font-semibold",children:b.name}),(0,r.jsxs)("p",{className:"text-xs sm:text-sm text-gray-500",children:["Minimum order: $",b.minimumOrder.toFixed(2)]})]})]}),(0,r.jsx)("div",{className:"divide-y",children:Object.entries(p).map(e=>{let[t,s]=e,a=u.find(e=>e.id===t);if(!a)return null;let o=a.onSale&&a.salePrice||a.price,n=o*s;return(0,r.jsx)("div",{className:"p-3 sm:p-4 hover:bg-gray-50 transition-colors",children:(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"w-16 h-16 sm:w-20 sm:h-20 rounded-md overflow-hidden mr-3 sm:mr-4 flex-shrink-0",children:(0,r.jsx)("img",{src:a.image,alt:a.name,className:"w-full h-full object-cover"})}),(0,r.jsxs)("div",{className:"flex-grow",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-1.5 sm:mb-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm sm:text-base font-semibold",children:a.name}),(0,r.jsx)("p",{className:"text-xs sm:text-sm text-gray-500",children:a.description}),(0,r.jsxs)("div",{className:"flex items-center mt-0.5 sm:mt-1",children:[(0,r.jsxs)("span",{className:"text-sm sm:text-base text-brand-600 font-medium",children:["$",o.toFixed(2)]}),a.onSale&&(0,r.jsxs)("span",{className:"text-gray-400 line-through ml-2 text-sm",children:["$",a.price.toFixed(2)]}),(0,r.jsxs)("span",{className:"text-gray-500 text-sm ml-2",children:["/ ",a.unit]})]})]}),(0,r.jsx)("button",{onClick:()=>O(t),className:"text-red-500 hover:text-red-600 p-1",title:"Remove from cart",children:(0,r.jsx)(l.Z,{className:"h-5 w-5"})})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between mt-2 sm:mt-3",children:[(0,r.jsxs)("div",{className:"flex items-center border rounded-md",children:[(0,r.jsx)("button",{onClick:()=>S(t,s-1),className:"p-1.5 sm:p-2 hover:bg-gray-100 transition-colors active:scale-95 touch-manipulation",children:(0,r.jsx)(c.Z,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"})}),(0,r.jsx)("span",{className:"px-3 sm:px-4 py-1.5 sm:py-2 font-medium min-w-[2.5rem] sm:min-w-[3rem] text-center text-sm sm:text-base",children:s}),(0,r.jsx)("button",{onClick:()=>S(t,s+1),className:"p-1.5 sm:p-2 hover:bg-gray-100 transition-colors active:scale-95 touch-manipulation",children:(0,r.jsx)(m.Z,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"})})]}),(0,r.jsx)("div",{className:"text-right",children:(0,r.jsxs)("p",{className:"font-semibold text-base sm:text-lg",children:["$",n.toFixed(2)]})})]})]})]})},t)})})]}),(0,r.jsx)("button",{onClick:()=>e.push(g?"/stores/".concat(g):"/stores"),className:"mt-3 sm:mt-4 text-brand-500 hover:text-brand-600 font-medium flex items-center text-sm sm:text-base active:scale-95 touch-manipulation",children:"‚Üê Continue Shopping"})]}),(0,r.jsx)("div",{className:"lg:w-1/3",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 sm:p-6 sticky top-4",children:[(0,r.jsx)("h2",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:"Order Summary"}),(0,r.jsxs)("div",{className:"space-y-2 sm:space-y-3 mb-3 sm:mb-4",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm sm:text-base",children:[(0,r.jsxs)("span",{className:"text-gray-600",children:["Items (",Object.keys(p).length,")"]}),(0,r.jsxs)("span",{className:"font-medium",children:["$",N.toFixed(2)]})]}),b&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Delivery Fee"}),(0,r.jsxs)("span",{className:"text-gray-600",children:["$",b.deliveryFee.toFixed(2)]})]}),(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Tax (estimated)"}),(0,r.jsxs)("span",{className:"text-gray-600",children:["$",(.0875*N).toFixed(2)]})]})]})]}),(0,r.jsx)("div",{className:"border-t pt-3 sm:pt-4 mb-4 sm:mb-6",children:(0,r.jsxs)("div",{className:"flex justify-between font-bold text-base sm:text-lg",children:[(0,r.jsx)("span",{children:"Estimated Total"}),(0,r.jsxs)("span",{children:["$",b?(N+b.deliveryFee+.0875*N).toFixed(2):N.toFixed(2)]})]})}),b&&N<b.minimumOrder&&(0,r.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-3 mb-4",children:(0,r.jsxs)("p",{className:"text-sm text-yellow-800",children:["Add $",(b.minimumOrder-N).toFixed(2)," more to reach the minimum order amount"]})}),(0,r.jsxs)("button",{onClick:()=>{if(0===Object.keys(p).length){alert("Your cart is empty");return}if(b&&N<b.minimumOrder){alert("Minimum order amount is $".concat(b.minimumOrder.toFixed(2)));return}e.push("/checkout")},disabled:b&&N<b.minimumOrder,className:"w-full bg-brand-500 text-white py-2.5 sm:py-3 rounded-md hover:bg-brand-600 transition-colors font-medium flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed text-sm sm:text-base active:scale-95 touch-manipulation",children:["Proceed to Checkout",(0,r.jsx)(d.Z,{className:"ml-2 h-5 w-5"})]}),(0,r.jsx)("p",{className:"text-[10px] sm:text-xs text-gray-500 text-center mt-3 sm:mt-4",children:"Tax and delivery fee calculated at checkout"})]})})]})]})}},4190:function(e,t,s){"use strict";s.d(t,{H:function(){return h},a:function(){return x}});var r=s(7437),a=s(2265),o=s(605);let n=s(3464).Z.create({baseURL:"http://localhost:5001/api",headers:{"Content-Type":"application/json"},timeout:1e4});n.interceptors.request.use(e=>{{let t=localStorage.getItem("token");t&&(e.headers.Authorization="Bearer ".concat(t))}return e},e=>Promise.reject(e)),n.interceptors.response.use(e=>e,async e=>{var t;let s=e.config;return((null===(t=e.response)||void 0===t?void 0:t.status)===401&&(localStorage.removeItem("token"),window.location.href="/auth/login"),(!e.response||e.response.status>=500&&e.response.status<600)&&s&&!s._retry&&(s._retryCount=s._retryCount||0,s._retryCount<2))?(s._retryCount+=1,s._retry=!0,await new Promise(e=>setTimeout(e,1e3*Math.pow(2,s._retryCount))),n(s)):Promise.reject(e)});let i=[{id:"1",name:"Admin User",email:"admin@example.com",phone:"555-123-4567",role:"admin"},{id:"2",name:"Test User",email:"user@example.com",phone:"555-987-6543",role:"customer"},{id:"3",name:"Shopper User",email:"shopper@example.com",phone:"555-456-7890",role:"shopper"}],l=()=>"mock-token-".concat(Math.random().toString(36).substring(2,15)),c=(e,t)=>new Promise((t,s)=>{let r=i.find(t=>t.email===e);r?t({token:l(),user:r}):s(Error("Invalid credentials"))}),m=e=>new Promise((t,s)=>{if(i.find(t=>t.email===e.email)){s(Error("User already exists"));return}let r={id:"".concat(i.length+1),name:e.name,email:e.email,phone:e.phone,role:"customer"};i.push(r),t({token:l(),user:r})}),d=()=>new Promise(e=>{if(!localStorage.getItem("token")){e(null);return}e(i[1])}),u=(0,a.createContext)(void 0),h=e=>{let{children:t}=e,{data:s,status:n}=(0,o.useSession)(),[i,l]=(0,a.useState)(null),[h,x]=(0,a.useState)(null),[p,f]=(0,a.useState)(!0);(0,a.useEffect)(()=>{let e=async()=>{let e=localStorage.getItem("userData"),t=localStorage.getItem("token");if(t&&e)try{let s=JSON.parse(e),r=s.timestamp||0;if(Date.now()-r<6048e5){x(t),l(s.user),f(!1);return}}catch(e){console.error("Error parsing cached user data:",e)}if(t){x(t);try{let e;(e=await d())&&(localStorage.setItem("userData",JSON.stringify({user:e,timestamp:Date.now()})),l(e))}catch(e){console.error("Authentication error:",e),localStorage.removeItem("token"),localStorage.removeItem("userData"),x(null)}}f(!1)};if("loading"===n){f(!0);return}if(null==s?void 0:s.user){l({id:s.user.id||s.user.email||"",name:s.user.name||"",email:s.user.email||"",role:"customer"}),x(s.accessToken||"google-oauth-token"),f(!1);return}e()},[s,n]);let g=(0,a.useCallback)(async(e,t)=>{f(!0);try{{let{token:s,user:r}=await c(e,t);localStorage.setItem("token",s),localStorage.setItem("userData",JSON.stringify({user:r,timestamp:Date.now()})),x(s),l(r)}}catch(e){throw console.error("Login error:",e),e}finally{f(!1)}},[]),y=(0,a.useCallback)(async e=>{f(!0);try{{let{token:t,user:s}=await m(e);localStorage.setItem("token",t),localStorage.setItem("userData",JSON.stringify({user:s,timestamp:Date.now()})),x(t),l(s)}}catch(e){throw console.error("Registration error:",e),e}finally{f(!1)}},[]),b=(0,a.useCallback)(async e=>{f(!0);try{let t={...i,...e};l(t),localStorage.setItem("userData",JSON.stringify({user:t,timestamp:Date.now()}))}catch(e){throw console.error("Profile update error:",e),e}finally{f(!1)}},[i,h]),j=(0,a.useCallback)(async()=>{s&&await (0,o.signOut)({redirect:!1}),localStorage.removeItem("token"),localStorage.removeItem("userData"),localStorage.removeItem("cart"),x(null),l(null),window.location.href="/"},[s]),v=(0,a.useMemo)(()=>({user:i,token:h,isLoading:p,isAuthenticated:!!i,login:g,register:y,logout:j,updateProfile:b}),[i,h,p,g,y,j,b]);return(0,r.jsx)(u.Provider,{value:v,children:t})},x=()=>{let e=(0,a.useContext)(u);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},407:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},1047:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]])},9397:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},2449:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]])},8930:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},9376:function(e,t,s){"use strict";var r=s(5475);s.o(r,"useParams")&&s.d(t,{useParams:function(){return r.useParams}}),s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}})}},function(e){e.O(0,[578,971,117,744],function(){return e(e.s=8911)}),_N_E=e.O()}]);