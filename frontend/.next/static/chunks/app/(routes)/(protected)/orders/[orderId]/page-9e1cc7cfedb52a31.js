(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[279],{7136:function(e,s,a){Promise.resolve().then(a.bind(a,8577))},8577:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return b}});var t=a(7437),r=a(2265),d=a(9376),l=a(7648),i=a(3145),c=a(4127);function n(e){let{className:s}=e;return(0,t.jsxs)("div",{className:(0,c.cn)("flex items-center",s),children:[(0,t.jsx)("div",{className:"w-16 h-16 rounded-md bg-gray-200 mr-4 animate-pulse"}),(0,t.jsxs)("div",{className:"flex-grow",children:[(0,t.jsx)("div",{className:"h-5 bg-gray-200 rounded-md w-1/2 mb-2 animate-pulse"}),(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded-md w-1/3 animate-pulse"})]}),(0,t.jsx)("div",{className:"w-12 h-5 bg-gray-200 rounded-md animate-pulse"})]})}var o=a(4190),m=a(1723),x=a(4794),h=a(9763);let u=(0,h.Z)("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]);var g=a(401),p=a(2489),j=a(2449);let f=(0,h.Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);var y=a(3774),v=a(8226);let N=[{id:"prod1",name:"Organic Bananas",description:"Sweet and nutritious organic bananas, perfect for snacking or baking.",price:.79,salePrice:.69,onSale:!0,image:"https://images.unsplash.com/photo-1543218024-57a70143c369?auto=format&fit=crop&w=300&q=80",category:"Produce",unit:"each",stock:100},{id:"prod2",name:"Avocado",description:"Ripe and ready to eat avocados, perfect for guacamole or toast.",price:1.99,image:"https://images.unsplash.com/photo-1523049673857-eb18f1d7b578?auto=format&fit=crop&w=300&q=80",category:"Produce",unit:"each",stock:50}];function b(){let e=(0,d.useParams)(),s=(0,d.useRouter)(),{orderId:a}=e,{user:c,isAuthenticated:h,isLoading:b}=(0,o.a)(),[w,k]=(0,r.useState)(null),[S,Z]=(0,r.useState)(!0),M=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return((0,r.useEffect)(()=>{if(!b){if(!h){s.push("/auth/login");return}(async()=>{Z(!0);let e="order_".concat(a),s=sessionStorage.getItem(e);if(s)try{let e=JSON.parse(s),a=new Date(e.date),t=new Date,r=Math.floor((t.getTime()-a.getTime())/6e4),d=e.status;r>30&&"processing"===d&&(d="out_for_delivery"),r>60&&"out_for_delivery"===d&&(d="delivered"),k({...e,status:d}),Z(!1);return}catch(e){console.error("Error parsing cached order:",e)}try{let s=new AbortController,t=setTimeout(()=>s.abort(),3e3);try{let r=await fetch("http://localhost:5001/api/orders/".concat(a),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))},signal:s.signal});if(clearTimeout(t),r.ok){let s=await r.json();sessionStorage.setItem(e,JSON.stringify(s)),k(s),Z(!1);return}}catch(e){clearTimeout(t),console.log("API fetch failed, using fallback:",e)}let r=localStorage.getItem("orders");if(r){let s=JSON.parse(r).find(e=>e.id===a);if(s){let a=new Date(s.date),t=new Date,r=Math.floor((t.getTime()-a.getTime())/6e4),d=s.status;r>30&&(d="out_for_delivery"),r>60&&(d="delivered");let l={...s,status:d};sessionStorage.setItem(e,JSON.stringify(l)),k(l),Z(!1);return}}let d={id:a,date:new Date().toISOString(),status:"processing",items:{prod1:2,prod2:1},store:{id:"store1",name:"Fresh Grocery",logo:"/images/store1.jpg"},subtotal:3.37,tax:.29,deliveryFee:3.99,total:7.65,address:{street:"123 Main St",city:"San Francisco",state:"CA",zipCode:"94105"},deliveryTime:"Today, 2:00 PM - 3:00 PM",paymentMethod:{brand:"Visa",last4:"4242"}};sessionStorage.setItem(e,JSON.stringify(d)),k(d)}catch(e){console.error("Error in order fetching flow:",e),k({id:a,date:new Date().toISOString(),status:"processing",items:{prod1:2,prod2:1},store:{id:"store1",name:"Fresh Grocery",logo:"/images/store1.jpg"},subtotal:3.37,tax:.29,deliveryFee:3.99,total:7.65,address:{street:"123 Main St",city:"San Francisco",state:"CA",zipCode:"94105"},deliveryTime:"Today, 2:00 PM - 3:00 PM",paymentMethod:{brand:"Visa",last4:"4242"}})}finally{Z(!1)}})()}},[b,h,a,s]),b||S)?(0,t.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsx)("div",{className:"h-6 w-32 bg-gray-200 rounded-md animate-pulse"})}),(0,t.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"h-8 w-48 bg-gray-200 rounded-md animate-pulse mb-2"}),(0,t.jsx)("div",{className:"h-5 w-36 bg-gray-200 rounded-md animate-pulse"})]}),(0,t.jsx)("div",{className:"mt-2 md:mt-0 h-6 w-24 bg-gray-200 rounded-full animate-pulse"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,t.jsxs)("div",{className:"flex items-center mb-4",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full bg-gray-200 animate-pulse mr-3"}),(0,t.jsx)("div",{className:"h-6 w-32 bg-gray-200 rounded-md animate-pulse"})]}),(0,t.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0].map((e,s)=>(0,t.jsx)(n,{},s))})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,t.jsx)("div",{className:"h-6 w-48 bg-gray-200 rounded-md animate-pulse mb-4"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"h-6 w-36 bg-gray-200 rounded-md animate-pulse mb-2"}),(0,t.jsx)("div",{className:"h-4 w-48 bg-gray-200 rounded-md animate-pulse mb-1"}),(0,t.jsx)("div",{className:"h-4 w-32 bg-gray-200 rounded-md animate-pulse"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"h-6 w-32 bg-gray-200 rounded-md animate-pulse mb-2"}),(0,t.jsx)("div",{className:"h-4 w-40 bg-gray-200 rounded-md animate-pulse"})]})]})]})]}),(0,t.jsx)("div",{className:"lg:col-span-1",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,t.jsx)("div",{className:"h-6 w-36 bg-gray-200 rounded-md animate-pulse mb-4"}),(0,t.jsx)("div",{className:"space-y-2 mb-4",children:[void 0,void 0,void 0,void 0].map((e,s)=>(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("div",{className:"h-4 w-20 bg-gray-200 rounded-md animate-pulse"}),(0,t.jsx)("div",{className:"h-4 w-16 bg-gray-200 rounded-md animate-pulse"})]},s))}),(0,t.jsx)("div",{className:"h-10 w-full bg-gray-200 rounded-md animate-pulse mt-6"}),(0,t.jsx)("div",{className:"h-10 w-full bg-gray-200 rounded-md animate-pulse mt-3"})]})})]})]}):w?(0,t.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsxs)(l.default,{href:"/orders",className:"flex items-center text-brand-500 font-medium",children:[(0,t.jsx)(f,{className:"mr-2 h-4 w-4"}),"Back to Orders"]})}),(0,t.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"text-2xl font-bold",children:["Order #",w.id]}),(0,t.jsxs)("p",{className:"text-gray-600",children:["Placed on ",M(w.date)]})]}),(0,t.jsxs)("div",{className:"".concat((e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800";case"processing":return"bg-blue-100 text-blue-800";case"out_for_delivery":return"bg-purple-100 text-purple-800";case"delivered":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(w.status)," px-3 py-1 rounded-full flex items-center mt-2 md:mt-0"),children:[(e=>{switch(e){case"pending":default:return(0,t.jsx)(m.Z,{className:"h-5 w-5"});case"processing":return(0,t.jsx)(x.Z,{className:"h-5 w-5"});case"out_for_delivery":return(0,t.jsx)(u,{className:"h-5 w-5"});case"delivered":return(0,t.jsx)(g.Z,{className:"h-5 w-5"});case"cancelled":return(0,t.jsx)(p.Z,{className:"h-5 w-5"})}})(w.status),(0,t.jsx)("span",{className:"ml-1 font-medium capitalize",children:w.status.replace("_"," ")})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,t.jsxs)("div",{className:"flex items-center mb-4",children:[(0,t.jsx)("div",{className:"relative w-10 h-10 rounded-full overflow-hidden mr-3 flex-shrink-0",children:(0,t.jsx)(i.default,{src:w.store.logo||"/images/store-placeholder.jpg",alt:w.store.name,fill:!0,sizes:"40px",className:"object-cover",priority:!0})}),(0,t.jsx)("h2",{className:"text-lg font-semibold",children:w.store.name})]}),(0,t.jsx)("div",{className:"space-y-4",children:Object.entries(w.items).map(e=>{let[s,a]=e,r=N.find(e=>e.id===s);if(!r)return null;let d=r.onSale&&r.salePrice||r.price,l=d*a;return(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"relative w-16 h-16 rounded-md overflow-hidden mr-4 flex-shrink-0",children:(0,t.jsx)(i.default,{src:r.image||"/images/product-placeholder.jpg",alt:r.name,fill:!0,sizes:"64px",className:"object-cover"})}),(0,t.jsxs)("div",{className:"flex-grow",children:[(0,t.jsx)("h3",{className:"font-medium",children:r.name}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:["$",d.toFixed(2)," \xd7 ",a," ",r.unit,a>1?"s":""]})]}),(0,t.jsxs)("div",{className:"font-medium",children:["$",l.toFixed(2)]})]},s)})})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Delivery Information"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center mb-2",children:[(0,t.jsx)(y.Z,{className:"h-5 w-5 text-gray-400 mr-2"}),(0,t.jsx)("h3",{className:"font-medium",children:"Delivery Address"})]}),(0,t.jsx)("p",{className:"text-gray-600",children:w.address.street}),(0,t.jsxs)("p",{className:"text-gray-600",children:[w.address.city,", ",w.address.state," ",w.address.zipCode]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center mb-2",children:[(0,t.jsx)(m.Z,{className:"h-5 w-5 text-gray-400 mr-2"}),(0,t.jsx)("h3",{className:"font-medium",children:"Delivery Time"})]}),(0,t.jsx)("p",{className:"text-gray-600",children:w.deliveryTime})]})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Order Timeline"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"absolute left-4 top-0 bottom-0 w-0.5 bg-gray-200"}),(0,t.jsxs)("div",{className:"relative pl-12 pb-8",children:[(0,t.jsx)("div",{className:"absolute left-0 rounded-full bg-green-500 text-white w-8 h-8 flex items-center justify-center",children:(0,t.jsx)(g.Z,{className:"h-5 w-5"})}),(0,t.jsx)("h3",{className:"font-medium",children:"Order Placed"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:M(w.date)})]}),(0,t.jsxs)("div",{className:"relative pl-12 pb-8 ".concat("pending"===w.status?"opacity-50":""),children:[(0,t.jsx)("div",{className:"absolute left-0 rounded-full w-8 h-8 flex items-center justify-center ".concat("pending"!==w.status?"bg-green-500 text-white":"bg-gray-200 text-gray-500"),children:"pending"!==w.status?(0,t.jsx)(g.Z,{className:"h-5 w-5"}):(0,t.jsx)(x.Z,{className:"h-5 w-5"})}),(0,t.jsx)("h3",{className:"font-medium",children:"Order Processing"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Your order is being prepared"})]}),(0,t.jsxs)("div",{className:"relative pl-12 pb-8 ".concat(["pending","processing"].includes(w.status)?"opacity-50":""),children:[(0,t.jsx)("div",{className:"absolute left-0 rounded-full w-8 h-8 flex items-center justify-center ".concat("out_for_delivery"===w.status||"delivered"===w.status?"bg-green-500 text-white":"bg-gray-200 text-gray-500"),children:"out_for_delivery"===w.status||"delivered"===w.status?(0,t.jsx)(g.Z,{className:"h-5 w-5"}):(0,t.jsx)(u,{className:"h-5 w-5"})}),(0,t.jsx)("h3",{className:"font-medium",children:"Out for Delivery"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Your order is on its way"})]}),(0,t.jsxs)("div",{className:"relative pl-12 ".concat("delivered"!==w.status?"opacity-50":""),children:[(0,t.jsx)("div",{className:"absolute left-0 rounded-full w-8 h-8 flex items-center justify-center ".concat("delivered"===w.status?"bg-green-500 text-white":"bg-gray-200 text-gray-500"),children:"delivered"===w.status?(0,t.jsx)(g.Z,{className:"h-5 w-5"}):(0,t.jsx)(j.Z,{className:"h-5 w-5"})}),(0,t.jsx)("h3",{className:"font-medium",children:"Delivered"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Enjoy your groceries!"})]})]})]})]}),(0,t.jsx)("div",{className:"lg:col-span-1",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 sticky top-4",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Order Summary"}),(0,t.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Subtotal"}),(0,t.jsxs)("span",{children:["$",w.subtotal.toFixed(2)]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Tax"}),(0,t.jsxs)("span",{children:["$",w.tax.toFixed(2)]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Delivery Fee"}),(0,t.jsxs)("span",{children:["$",w.deliveryFee.toFixed(2)]})]}),(0,t.jsxs)("div",{className:"flex justify-between font-bold text-lg pt-2 border-t",children:[(0,t.jsx)("span",{children:"Total"}),(0,t.jsxs)("span",{children:["$",w.total.toFixed(2)]})]})]}),(0,t.jsxs)("div",{className:"border-t pt-4",children:[(0,t.jsxs)("div",{className:"flex items-center mb-2",children:[(0,t.jsx)(v.Z,{className:"h-5 w-5 text-gray-400 mr-2"}),(0,t.jsx)("h3",{className:"font-medium",children:"Payment Method"})]}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"mr-3",children:"Visa"===w.paymentMethod.brand?(0,t.jsx)("div",{className:"bg-blue-600 text-white text-xs font-bold px-2 py-1 rounded",children:"VISA"}):(0,t.jsx)("div",{className:"bg-red-600 text-white text-xs font-bold px-2 py-1 rounded",children:"MC"})}),(0,t.jsxs)("p",{className:"text-gray-600",children:["•••• ",w.paymentMethod.last4]})]})]}),(0,t.jsxs)("div",{className:"mt-6",children:[(0,t.jsx)(l.default,{href:"/stores/".concat(w.store.id),className:"block w-full bg-brand-500 text-white py-2 rounded-md hover:bg-brand-600 transition-colors text-center font-medium",children:"Order Again"}),(0,t.jsx)("button",{className:"w-full border border-gray-300 text-gray-700 py-2 rounded-md hover:bg-gray-50 transition-colors mt-3 font-medium",children:"Need Help?"})]})]})})]})]}):(0,t.jsxs)("div",{className:"container mx-auto px-4 py-8 text-center",children:[(0,t.jsx)(j.Z,{className:"mx-auto h-16 w-16 text-gray-400 mb-4"}),(0,t.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Order not found"}),(0,t.jsx)("p",{className:"mb-4",children:"We couldn't find the order you're looking for."}),(0,t.jsx)(l.default,{href:"/orders",className:"bg-brand-500 text-white px-4 py-2 rounded-md hover:bg-brand-600 transition-colors",children:"View All Orders"})]})}},401:function(e,s,a){"use strict";a.d(s,{Z:function(){return t}});let t=(0,a(9763).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},1723:function(e,s,a){"use strict";a.d(s,{Z:function(){return t}});let t=(0,a(9763).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},3774:function(e,s,a){"use strict";a.d(s,{Z:function(){return t}});let t=(0,a(9763).Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},2449:function(e,s,a){"use strict";a.d(s,{Z:function(){return t}});let t=(0,a(9763).Z)("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]])}},function(e){e.O(0,[972,578,726,336,643,971,117,744],function(){return e(e.s=7136)}),_N_E=e.O()}]);