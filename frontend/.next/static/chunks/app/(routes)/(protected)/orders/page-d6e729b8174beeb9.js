(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[337],{9413:function(e,t,s){Promise.resolve().then(s.bind(s,4147))},4147:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return d}});var r=s(7437),a=s(2265),o=s(7648),n=s(4190),l=s(2449),i=s(1723),c=s(407);let m=[{id:"ORD-231109-1234",date:new Date(Date.now()-1728e5).toISOString(),status:"delivered",total:45.67,items:5,store:{name:"Fresh Grocery",logo:"https://images.unsplash.com/photo-1534723452862-4c874018d66d?ixlib=rb-4.0.3&auto=format&fit=crop&w=100&q=80"}},{id:"ORD-231105-5678",date:new Date(Date.now()-6048e5).toISOString(),status:"delivered",total:32.99,items:3,store:{name:"Organic Market",logo:"https://images.unsplash.com/photo-1542838132-92c53300491e?ixlib=rb-4.0.3&auto=format&fit=crop&w=100&q=80"}}];function d(){let{user:e}=(0,n.a)(),[t,s]=(0,a.useState)(m),[d,u]=(0,a.useState)(!1),h=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),x=e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800";case"processing":return"bg-blue-100 text-blue-800";case"delivered":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return(0,r.jsxs)("div",{className:"container mx-auto px-4 sm:px-6 py-6 sm:py-8",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3 sm:gap-0 mb-4 sm:mb-6",children:[(0,r.jsx)("h1",{className:"text-xl sm:text-2xl font-bold",children:"Your Orders"}),(0,r.jsx)(o.default,{href:"/stores",className:"bg-brand-500 text-white px-4 py-2 rounded-md hover:bg-brand-600 transition-colors text-sm sm:text-base active:scale-95 touch-manipulation w-full sm:w-auto",children:"Shop Now"})]}),e&&(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-3 sm:p-4 mb-4 sm:mb-6",children:[(0,r.jsxs)("h2",{className:"text-base sm:text-lg font-semibold mb-1.5 sm:mb-2",children:["Welcome back, ",e.name,"!"]}),(0,r.jsx)("p",{className:"text-sm sm:text-base text-gray-600",children:"View your order history below or start shopping at our stores."})]}),d?(0,r.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-brand-500"})}):0===t.length?(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-8 text-center",children:[(0,r.jsx)(l.Z,{className:"mx-auto h-16 w-16 text-gray-400 mb-4"}),(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-700 mb-2",children:"No orders yet"}),(0,r.jsx)("p",{className:"text-gray-500 mb-4",children:"You haven't placed any orders yet. Start shopping to place your first order!"}),(0,r.jsx)(o.default,{href:"/stores",className:"bg-brand-500 text-white px-6 py-2 rounded-md hover:bg-brand-600 transition-colors",children:"Browse Stores"})]}):(0,r.jsx)("div",{className:"space-y-4",children:t.map(e=>(0,r.jsx)(o.default,{href:"/orders/".concat(e.id),className:"block bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow",children:(0,r.jsxs)("div",{className:"p-3 sm:p-4 md:p-6",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2 sm:gap-0 mb-3 sm:mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"w-9 h-9 sm:w-10 sm:h-10 rounded-full overflow-hidden mr-2 sm:mr-3 flex-shrink-0",children:(0,r.jsx)("img",{src:e.store.logo,alt:e.store.name,className:"w-full h-full object-cover"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm sm:text-base font-semibold",children:e.store.name}),(0,r.jsxs)("p",{className:"text-xs sm:text-sm text-gray-500 flex items-center",children:[(0,r.jsx)(i.Z,{size:12,className:"sm:w-3.5 sm:h-3.5 mr-1"}),h(e.date)]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"".concat(x(e.status)," text-[10px] sm:text-xs px-1.5 sm:px-2 py-0.5 sm:py-1 rounded-full capitalize"),children:e.status}),(0,r.jsxs)("span",{className:"text-sm sm:text-base font-semibold",children:["$",e.total.toFixed(2)]})]})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center text-xs sm:text-sm",children:[(0,r.jsxs)("span",{className:"text-gray-600",children:[e.items," items"]}),(0,r.jsxs)("div",{className:"flex items-center text-brand-500",children:[(0,r.jsx)("span",{children:"View details"}),(0,r.jsx)(c.Z,{size:14,className:"sm:w-4 sm:h-4"})]})]})]})},e.id))})]})}},4190:function(e,t,s){"use strict";s.d(t,{H:function(){return h},a:function(){return x}});var r=s(7437),a=s(2265),o=s(605);let n=s(3464).Z.create({baseURL:"http://localhost:5001/api",headers:{"Content-Type":"application/json"},timeout:1e4});n.interceptors.request.use(e=>{{let t=localStorage.getItem("token");t&&(e.headers.Authorization="Bearer ".concat(t))}return e},e=>Promise.reject(e)),n.interceptors.response.use(e=>e,async e=>{var t;let s=e.config;return((null===(t=e.response)||void 0===t?void 0:t.status)===401&&(localStorage.removeItem("token"),window.location.href="/auth/login"),(!e.response||e.response.status>=500&&e.response.status<600)&&s&&!s._retry&&(s._retryCount=s._retryCount||0,s._retryCount<2))?(s._retryCount+=1,s._retry=!0,await new Promise(e=>setTimeout(e,1e3*Math.pow(2,s._retryCount))),n(s)):Promise.reject(e)});let l=[{id:"1",name:"Admin User",email:"admin@example.com",phone:"555-123-4567",role:"admin"},{id:"2",name:"Test User",email:"user@example.com",phone:"555-987-6543",role:"customer"},{id:"3",name:"Shopper User",email:"shopper@example.com",phone:"555-456-7890",role:"shopper"}],i=()=>"mock-token-".concat(Math.random().toString(36).substring(2,15)),c=(e,t)=>new Promise((t,s)=>{let r=l.find(t=>t.email===e);r?t({token:i(),user:r}):s(Error("Invalid credentials"))}),m=e=>new Promise((t,s)=>{if(l.find(t=>t.email===e.email)){s(Error("User already exists"));return}let r={id:"".concat(l.length+1),name:e.name,email:e.email,phone:e.phone,role:"customer"};l.push(r),t({token:i(),user:r})}),d=()=>new Promise(e=>{if(!localStorage.getItem("token")){e(null);return}e(l[1])}),u=(0,a.createContext)(void 0),h=e=>{let{children:t}=e,{data:s,status:n}=(0,o.useSession)(),[l,i]=(0,a.useState)(null),[h,x]=(0,a.useState)(null),[p,g]=(0,a.useState)(!0);(0,a.useEffect)(()=>{let e=async()=>{let e=localStorage.getItem("userData"),t=localStorage.getItem("token");if(t&&e)try{let s=JSON.parse(e),r=s.timestamp||0;if(Date.now()-r<6048e5){x(t),i(s.user),g(!1);return}}catch(e){console.error("Error parsing cached user data:",e)}if(t){x(t);try{let e;(e=await d())&&(localStorage.setItem("userData",JSON.stringify({user:e,timestamp:Date.now()})),i(e))}catch(e){console.error("Authentication error:",e),localStorage.removeItem("token"),localStorage.removeItem("userData"),x(null)}}g(!1)};if("loading"===n){g(!0);return}if(null==s?void 0:s.user){i({id:s.user.id||s.user.email||"",name:s.user.name||"",email:s.user.email||"",role:"customer"}),x(s.accessToken||"google-oauth-token"),g(!1);return}e()},[s,n]);let f=(0,a.useCallback)(async(e,t)=>{g(!0);try{{let{token:s,user:r}=await c(e,t);localStorage.setItem("token",s),localStorage.setItem("userData",JSON.stringify({user:r,timestamp:Date.now()})),x(s),i(r)}}catch(e){throw console.error("Login error:",e),e}finally{g(!1)}},[]),w=(0,a.useCallback)(async e=>{g(!0);try{{let{token:t,user:s}=await m(e);localStorage.setItem("token",t),localStorage.setItem("userData",JSON.stringify({user:s,timestamp:Date.now()})),x(t),i(s)}}catch(e){throw console.error("Registration error:",e),e}finally{g(!1)}},[]),b=(0,a.useCallback)(async e=>{g(!0);try{let t={...l,...e};i(t),localStorage.setItem("userData",JSON.stringify({user:t,timestamp:Date.now()}))}catch(e){throw console.error("Profile update error:",e),e}finally{g(!1)}},[l,h]),y=(0,a.useCallback)(async()=>{s&&await (0,o.signOut)({redirect:!1}),localStorage.removeItem("token"),localStorage.removeItem("userData"),localStorage.removeItem("cart"),x(null),i(null),window.location.href="/"},[s]),v=(0,a.useMemo)(()=>({user:l,token:h,isLoading:p,isAuthenticated:!!l,login:f,register:w,logout:y,updateProfile:b}),[l,h,p,f,w,y,b]);return(0,r.jsx)(u.Provider,{value:v,children:t})},x=()=>{let e=(0,a.useContext)(u);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},407:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},1723:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},2449:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]])},7648:function(e,t,s){"use strict";s.d(t,{default:function(){return a.a}});var r=s(2972),a=s.n(r)}},function(e){e.O(0,[972,578,971,117,744],function(){return e(e.s=9413)}),_N_E=e.O()}]);