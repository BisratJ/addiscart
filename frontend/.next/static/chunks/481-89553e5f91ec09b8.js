"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[481],{4190:function(e,t,r){r.d(t,{H:function(){return d},a:function(){return y}});var a=r(7437),o=r(2265),n=r(605);let s=r(3464).Z.create({baseURL:"http://localhost:5001/api",headers:{"Content-Type":"application/json"},timeout:1e4});s.interceptors.request.use(e=>{{let t=localStorage.getItem("token");t&&(e.headers.Authorization="Bearer ".concat(t))}return e},e=>Promise.reject(e)),s.interceptors.response.use(e=>e,async e=>{var t;let r=e.config;return((null===(t=e.response)||void 0===t?void 0:t.status)===401&&(localStorage.removeItem("token"),window.location.href="/auth/login"),(!e.response||e.response.status>=500&&e.response.status<600)&&r&&!r._retry&&(r._retryCount=r._retryCount||0,r._retryCount<2))?(r._retryCount+=1,r._retry=!0,await new Promise(e=>setTimeout(e,1e3*Math.pow(2,r._retryCount))),s(r)):Promise.reject(e)});let i=[{id:"1",name:"Admin User",email:"admin@example.com",phone:"555-123-4567",role:"admin"},{id:"2",name:"Test User",email:"user@example.com",phone:"555-987-6543",role:"customer"},{id:"3",name:"Shopper User",email:"shopper@example.com",phone:"555-456-7890",role:"shopper"}],l=()=>"mock-token-".concat(Math.random().toString(36).substring(2,15)),u=(e,t)=>new Promise((t,r)=>{let a=i.find(t=>t.email===e);a?t({token:l(),user:a}):r(Error("Invalid credentials"))}),c=e=>new Promise((t,r)=>{if(i.find(t=>t.email===e.email)){r(Error("User already exists"));return}let a={id:"".concat(i.length+1),name:e.name,email:e.email,phone:e.phone,role:"customer"};i.push(a),t({token:l(),user:a})}),m=()=>new Promise(e=>{if(!localStorage.getItem("token")){e(null);return}e(i[1])}),h=(0,o.createContext)(void 0),d=e=>{let{children:t}=e,{data:r,status:s}=(0,n.useSession)(),[i,l]=(0,o.useState)(null),[d,y]=(0,o.useState)(null),[f,p]=(0,o.useState)(!0);(0,o.useEffect)(()=>{let e=async()=>{let e=localStorage.getItem("userData"),t=localStorage.getItem("token");if(t&&e)try{let r=JSON.parse(e),a=r.timestamp||0;if(Date.now()-a<6048e5){y(t),l(r.user),p(!1);return}}catch(e){console.error("Error parsing cached user data:",e)}if(t){y(t);try{let e;(e=await m())&&(localStorage.setItem("userData",JSON.stringify({user:e,timestamp:Date.now()})),l(e))}catch(e){console.error("Authentication error:",e),localStorage.removeItem("token"),localStorage.removeItem("userData"),y(null)}}p(!1)};if("loading"===s){p(!0);return}if(null==r?void 0:r.user){l({id:r.user.id||r.user.email||"",name:r.user.name||"",email:r.user.email||"",role:"customer"}),y(r.accessToken||"google-oauth-token"),p(!1);return}e()},[r,s]);let g=(0,o.useCallback)(async(e,t)=>{p(!0);try{{let{token:r,user:a}=await u(e,t);localStorage.setItem("token",r),localStorage.setItem("userData",JSON.stringify({user:a,timestamp:Date.now()})),y(r),l(a)}}catch(e){throw console.error("Login error:",e),e}finally{p(!1)}},[]),k=(0,o.useCallback)(async e=>{p(!0);try{{let{token:t,user:r}=await c(e);localStorage.setItem("token",t),localStorage.setItem("userData",JSON.stringify({user:r,timestamp:Date.now()})),y(t),l(r)}}catch(e){throw console.error("Registration error:",e),e}finally{p(!1)}},[]),w=(0,o.useCallback)(async e=>{p(!0);try{let t={...i,...e};l(t),localStorage.setItem("userData",JSON.stringify({user:t,timestamp:Date.now()}))}catch(e){throw console.error("Profile update error:",e),e}finally{p(!1)}},[i,d]),S=(0,o.useCallback)(async()=>{r&&await (0,n.signOut)({redirect:!1}),localStorage.removeItem("token"),localStorage.removeItem("userData"),localStorage.removeItem("cart"),y(null),l(null),window.location.href="/"},[r]),v=(0,o.useMemo)(()=>({user:i,token:d,isLoading:f,isAuthenticated:!!i,login:g,register:k,logout:S,updateProfile:w}),[i,d,f,g,k,S,w]);return(0,a.jsx)(h.Provider,{value:v,children:t})},y=()=>{let e=(0,o.useContext)(h);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},7769:function(e,t,r){r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]])},2208:function(e,t,r){r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},6337:function(e,t,r){r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},9345:function(e,t,r){r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},6275:function(e,t,r){r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]])},7648:function(e,t,r){r.d(t,{default:function(){return o.a}});var a=r(2972),o=r.n(a)},9376:function(e,t,r){var a=r(5475);r.o(a,"useParams")&&r.d(t,{useParams:function(){return a.useParams}}),r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})}}]);